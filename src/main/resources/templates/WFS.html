<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.4.3/css/ol.css">
    <style>
        #map {
            height: 1200px;
            width: 100%;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.4.3/build/ol.js"></script>
    <title>GEOorWeb</title>
</head>
<body>
<h2>OpenLayers_MAP</h2>
<div id="map" ></div>
<script type="text/javascript">

    var vectorSource = new ol.source.Vector({
        format: new ol.format.GeoJSON(),
        url: function (extent) {
            console.log(extent.join(','));
            var strUrl = 'http://localhost:8088/geoserver/GeoOr/wfs?' +
                'service=WFS&' +
                'version=1.1.0&' +
                'request=GetFeature&' +
                'typename=GeoOr:PostGis_SHP&' +
                'outputFormat=application/json&' +
                'srsname=EPSG:3857&' +
                'bbox=' + extent.join(',') + ',EPSG:3857';
            return strUrl;
        },
        strategy: ol.loadingstrategy.bbox
    });

    var vector = new ol.layer.Vector({
        className: "wfsLayer",
        source: vectorSource,
        style: new ol.style.Style({
            stroke: new ol.style.Stroke({
                color: 'rgba(0, 0, 255, 1.0)',
                width: 2
            })
        })
    })

    // vworld 배경지도 띄우기
    var map = new ol.Map({
        target: 'map',
        layers: [
            new ol.layer.Tile({
                source: new ol.source.XYZ({
                    url: 'http://xdworld.vworld.kr:8080/2d/Base/202002/{z}/{x}/{y}.png'
                })
            }),
            vector
        ],
        view: new ol.View({
            center: [14126669.41589247, 4493404.190498611],
            zoom: 7,
            minZoom: 7,
            maxZoom: 19
        })
    });

    function test(){
        var features = vectorSource.getFeatures();
        console.log(features);
        console.log(features[0]['values_']);
        var style = new ol.style.Style({
            stroke: new ol.style.Stroke({color: '#d80303'}),
            fill: new ol.style.Fill({color: '#d80303'})
        });
        features[0].setStyle(style);
        features[1].setStyle(style);
        features[2].setStyle(style);
        features[3].setStyle(style);
        features[4].setStyle(style);
        features[5].setStyle(style);
        // console.log(vectorSource.getFeaturesCollection()); == null
        map.removeLayer(vector);
        map.addLayer(vector);
    }

</script>
<div>
    <button type="button" onclick="javascript:test();" name="test" >WFS 테스트용 버튼</button>
</div>
</body>
</html>